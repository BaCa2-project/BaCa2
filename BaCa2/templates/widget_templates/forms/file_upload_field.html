{% load custom_tags %}

<div class="input-block table-select-field mb-3">
    <div class="{% if form_widget.live_validation %} live-validation {% endif %}">
        <label for="{{ field.name }}" class="form-label">{{ field.label }}</label>
        {% if form_widget.display_field_errors and form_widget.form.is_bound %}
            {% if field.errors %}
                {% with "form-control is-invalid" as field_class %}
                {% include "widget_templates/forms/field_render.html" %}
                {% endwith %}
            {% else %}
                {% with "form-control is-invalid" as field_class %}
                {% include "widget_templates/forms/field_render.html" %}
                {% endwith %}
            {% endif %}
        {% else %}
            {% with "form-control" as field_class %}
            {% include "widget_templates/forms/field_render.html" %}
            {% endwith %}
        {% endif %}
    </div>
</div>

{% if form_widget.live_validation %}
    <script>
        $(document).ready(function () {
            $('#{{ field.name }}').on('input', function () {
                update_validation_status(
                    this,
                    '{{ form_widget.form_cls }}',
                    '{{ form_widget.field_min_length|get_item:field.name }}',
                    '{% url 'field-validation' %}');
            });
        });
    </script>
{% endif %}
